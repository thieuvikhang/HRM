<?xml version="1.0" encoding="utf-8"?>
<Dashboard CurrencyCulture="vi-VN">
  <Title Text="Thống kê nhân viên" />
  <DataSources>
    <SqlDataSource ComponentName="dashboardSqlDataSource1">
      <Name>SQL Data Source 1</Name>
      <Connection Name="DESKTOP-CPSQQQU\SQLEXPRESS_HRM_Connection" ProviderKey="MSSqlServer">
        <Parameters>
          <Parameter Name="server" Value="DESKTOP-CPSQQQU\SQLEXPRESS" />
          <Parameter Name="database" Value="HRM" />
          <Parameter Name="useIntegratedSecurity" Value="True" />
          <Parameter Name="read only" Value="1" />
          <Parameter Name="generateConnectionHelper" Value="false" />
          <Parameter Name="userid" Value="" />
          <Parameter Name="password" Value="" />
        </Parameters>
      </Connection>
      <Query Type="SelectQuery" Name="Staff">
        <Tables>
          <Table Name="Staff" />
          <Table Name="Position" />
          <Table Name="Section" />
          <Relation Type="Inner" Parent="Staff" Nested="Position">
            <KeyColumn Parent="PostID" Nested="PostID" />
          </Relation>
          <Relation Type="Inner" Parent="Staff" Nested="Section">
            <KeyColumn Parent="SectionID" Nested="SectionID" />
          </Relation>
        </Tables>
        <Columns>
          <AllColumns Table="Staff" />
          <AllColumns Table="Section" />
          <AllColumns Table="Position" />
        </Columns>
      </Query>
      <Query Type="SelectQuery" Name="Absent">
        <Tables>
          <Table Name="Absent" />
          <Table Name="Staff" />
          <Relation Type="Inner" Parent="Absent" Nested="Staff">
            <KeyColumn Parent="StaffID" Nested="StaffID" />
          </Relation>
        </Tables>
        <Columns>
          <AllColumns Table="Staff" />
          <AllColumns Table="Absent" />
        </Columns>
      </Query>
      <ResultSchema>
        <DataSet Name="SQL Data Source 1">
          <View Name="Absent">
            <Field Name="StaffID" Type="String" />
            <Field Name="StaffName" Type="String" />
            <Field Name="Image" Type="String" />
            <Field Name="Gender" Type="Boolean" />
            <Field Name="BirthDay" Type="DateTime" />
            <Field Name="CardID" Type="String" />
            <Field Name="Phone" Type="String" />
            <Field Name="Address" Type="String" />
            <Field Name="Education" Type="String" />
            <Field Name="StartDate" Type="DateTime" />
            <Field Name="EndDate" Type="DateTime" />
            <Field Name="ManagerID" Type="String" />
            <Field Name="Email" Type="String" />
            <Field Name="DaysRemain" Type="Int32" />
            <Field Name="PostID" Type="String" />
            <Field Name="SectionID" Type="String" />
            <Field Name="AbsentID" Type="Int32" />
            <Field Name="AbsentDay" Type="Int32" />
            <Field Name="FromDate" Type="DateTime" />
            <Field Name="ToDate" Type="DateTime" />
            <Field Name="AbsentType" Type="Boolean" />
            <Field Name="Note" Type="String" />
            <Field Name="Absent_StaffID" Type="String" />
          </View>
          <View Name="Staff">
            <Field Name="StaffID" Type="String" />
            <Field Name="StaffName" Type="String" />
            <Field Name="Image" Type="String" />
            <Field Name="Gender" Type="Boolean" />
            <Field Name="BirthDay" Type="DateTime" />
            <Field Name="CardID" Type="String" />
            <Field Name="Phone" Type="String" />
            <Field Name="Address" Type="String" />
            <Field Name="Education" Type="String" />
            <Field Name="StartDate" Type="DateTime" />
            <Field Name="EndDate" Type="DateTime" />
            <Field Name="ManagerID" Type="String" />
            <Field Name="Email" Type="String" />
            <Field Name="DaysRemain" Type="Int32" />
            <Field Name="PostID" Type="String" />
            <Field Name="SectionID" Type="String" />
            <Field Name="Section_SectionID" Type="String" />
            <Field Name="SectionName" Type="String" />
            <Field Name="Description" Type="String" />
            <Field Name="StandardWorkdays" Type="Int32" />
            <Field Name="Section_Phone" Type="String" />
            <Field Name="Position_PostID" Type="String" />
            <Field Name="PostName" Type="String" />
            <Field Name="Position_Description" Type="String" />
          </View>
        </DataSet>
      </ResultSchema>
      <ConnectionOptions CloseConnection="true" CommandTimeout="0" />
    </SqlDataSource>
    <SqlDataSource ComponentName="dashboardSqlDataSource2">
      <Name>SQL Data Source 2</Name>
      <Connection Name="DESKTOP-CPSQQQU\SQLEXPRESS_HRM_Connection" ProviderKey="MSSqlServer">
        <Parameters>
          <Parameter Name="server" Value="DESKTOP-CPSQQQU\SQLEXPRESS" />
          <Parameter Name="database" Value="HRM" />
          <Parameter Name="useIntegratedSecurity" Value="True" />
          <Parameter Name="read only" Value="1" />
          <Parameter Name="generateConnectionHelper" Value="false" />
          <Parameter Name="userid" Value="" />
          <Parameter Name="password" Value="" />
        </Parameters>
      </Connection>
      <Query Type="StoredProcQuery" Name="Sp_absent">
        <ProcName>Sp_absent</ProcName>
      </Query>
      <ResultSchema>
        <DataSet Name="SQL Data Source 2">
          <View Name="Sp_absent">
            <Field Name="AbsentType" Type="Boolean" />
            <Field Name="Name" Type="String" />
          </View>
        </DataSet>
      </ResultSchema>
      <ConnectionOptions CloseConnection="true" CommandTimeout="0" />
    </SqlDataSource>
  </DataSources>
  <Items>
    <Pie ComponentName="pieDashboardItem1" Name="Thống kê nhân viên theo chức vụ" ShowCaption="false" DataSource="dashboardSqlDataSource1" DataMember="Staff">
      <DataItems>
        <Measure DataMember="StaffID" Name=" Chức vụ" SummaryType="Count" UniqueName="DataItem1" />
        <Dimension DataMember="PostName" UniqueName="DataItem0" />
      </DataItems>
      <Arguments>
        <Argument UniqueName="DataItem0" />
      </Arguments>
      <Values>
        <Value UniqueName="DataItem1" />
      </Values>
    </Pie>
    <Pie ComponentName="pieDashboardItem2" Name="Thống kê nhân viên theo phòng ban" ShowCaption="false" DataSource="dashboardSqlDataSource1" DataMember="Staff">
      <DataItems>
        <Measure DataMember="StaffID" Name="Phòng ban " SummaryType="Count" UniqueName="DataItem1" />
        <Dimension DataMember="SectionName" UniqueName="DataItem0" />
      </DataItems>
      <Arguments>
        <Argument UniqueName="DataItem0" />
      </Arguments>
      <Values>
        <Value UniqueName="DataItem1" />
      </Values>
    </Pie>
    <Pie ComponentName="pieDashboardItem3" Name="Nghỉ phép" ShowCaption="false" DataSource="dashboardSqlDataSource2" DataMember="Sp_absent">
      <DataItems>
        <Dimension DataMember="Name" UniqueName="DataItem0" />
        <Measure DataMember="AbsentType" Name=" Nghỉ phép" SummaryType="Count" UniqueName="DataItem1" />
      </DataItems>
      <Arguments>
        <Argument UniqueName="DataItem0" />
      </Arguments>
      <Values>
        <Value UniqueName="DataItem1" />
      </Values>
    </Pie>
  </Items>
  <LayoutTree>
    <LayoutGroup>
      <LayoutItem DashboardItem="pieDashboardItem1" Weight="49.946524064171122" />
      <LayoutGroup Orientation="Vertical" Weight="50.053475935828878">
        <LayoutItem DashboardItem="pieDashboardItem2" Weight="50.053475935828878" />
        <LayoutItem DashboardItem="pieDashboardItem3" Weight="50.053475935828878" />
      </LayoutGroup>
    </LayoutGroup>
  </LayoutTree>
</Dashboard>